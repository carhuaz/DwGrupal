<!-- ============================================================
     MODAL: MIS PEDIDOS - Historial completo de pedidos
============================================================ -->
<div
  class="modal fade"
  id="misPedidosModal"
  tabindex="-1"
  aria-labelledby="misPedidosModalLabel"
  aria-hidden="true"
>
  <div
    class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"
  >
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="misPedidosModalLabel">
          <i class="bi bi-bag-check me-2"></i>Mis Pedidos
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Cerrar"
        ></button>
      </div>
      <div class="modal-body">
        <!-- Estadísticas Rápidas -->
        <div class="row mb-4" id="estadisticasPedidos">
          <div class="col-md-3 col-6 mb-3">
            <div class="card h-100">
              <div class="card-body text-center">
                <i class="bi bi-box-seam fs-1 text-primary"></i>
                <h3 class="mt-2 mb-0" id="stat-total-pedidos">0</h3>
                <small class="text-muted">Total Pedidos</small>
              </div>
            </div>
          </div>
          <div class="col-md-3 col-6 mb-3">
            <div class="card h-100">
              <div class="card-body text-center">
                <i class="bi bi-check-circle fs-1 text-success"></i>
                <h3 class="mt-2 mb-0" id="stat-completados">0</h3>
                <small class="text-muted">Completados</small>
              </div>
            </div>
          </div>
          <div class="col-md-3 col-6 mb-3">
            <div class="card h-100">
              <div class="card-body text-center">
                <i class="bi bi-truck fs-1 text-info"></i>
                <h3 class="mt-2 mb-0" id="stat-enviados">0</h3>
                <small class="text-muted">En Camino</small>
              </div>
            </div>
          </div>
          <div class="col-md-3 col-6 mb-3">
            <div class="card h-100">
              <div class="card-body text-center">
                <i class="bi bi-currency-dollar fs-1 text-warning"></i>
                <h3 class="mt-2 mb-0" id="stat-total-gastado">S/ 0.00</h3>
                <small class="text-muted">Total Gastado</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Filtros -->
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="btn-group" role="group">
            <button
              type="button"
              class="btn btn-outline-primary active"
              onclick="filtrarPedidosPorEstado('todos')"
            >
              Todos
            </button>
            <button
              type="button"
              class="btn btn-outline-warning"
              onclick="filtrarPedidosPorEstado('pendiente')"
            >
              Pendientes
            </button>
            <button
              type="button"
              class="btn btn-outline-info"
              onclick="filtrarPedidosPorEstado('enviado')"
            >
              Enviados
            </button>
            <button
              type="button"
              class="btn btn-outline-success"
              onclick="filtrarPedidosPorEstado('entregado')"
            >
              Entregados
            </button>
          </div>
          <button class="btn btn-primary" onclick="cargarMisPedidos()">
            <i class="bi bi-arrow-clockwise me-1"></i>Actualizar
          </button>
        </div>

        <!-- Lista de Pedidos -->
        <div id="listaPedidos">
          <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Cargando...</span>
            </div>
            <p class="mt-3">Cargando tus pedidos...</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ============================================================
     MODAL: DETALLE DE PEDIDO
============================================================ -->
<div
  class="modal fade"
  id="detallePedidoModal"
  tabindex="-1"
  aria-labelledby="detallePedidoModalLabel"
  aria-hidden="true"
>
  <div
    class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable"
  >
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="detallePedidoModalLabel">
          <i class="bi bi-receipt me-2"></i>Detalle del Pedido
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Cerrar"
        ></button>
      </div>
      <div class="modal-body" id="detallePedidoContent">
        <!-- El contenido se cargará dinámicamente -->
      </div>
    </div>
  </div>
</div>

<!-- ============================================================
     MODAL: CONFIRMAR COMPRA (desde carrito)
============================================================ -->
<div
  class="modal fade"
  id="confirmarCompraModal"
  tabindex="-1"
  aria-labelledby="confirmarCompraModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="confirmarCompraModalLabel">
          <i class="bi bi-credit-card me-2"></i>Finalizar Compra
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Cerrar"
        ></button>
      </div>
      <div class="modal-body">
        <form id="formConfirmarCompra">
          <!-- Información de Envío -->
          <h6 class="mb-3">
            <i class="bi bi-truck me-2"></i>Información de Envío
          </h6>

          <div class="row mb-3">
            <div class="col-md-6">
              <label for="compra-nombre" class="form-label"
                >Nombre Completo *</label
              >
              <input
                type="text"
                class="form-control"
                id="compra-nombre"
                required
              />
            </div>
            <div class="col-md-6">
              <label for="compra-telefono" class="form-label">Teléfono *</label>
              <input
                type="tel"
                class="form-control"
                id="compra-telefono"
                required
              />
            </div>
          </div>

          <div class="mb-3">
            <label for="compra-direccion" class="form-label">Dirección *</label>
            <input
              type="text"
              class="form-control"
              id="compra-direccion"
              required
            />
          </div>

          <div class="row mb-3">
            <div class="col-md-6">
              <label for="compra-ciudad" class="form-label">Ciudad *</label>
              <input
                type="text"
                class="form-control"
                id="compra-ciudad"
                required
              />
            </div>
            <div class="col-md-6">
              <label for="compra-codigo-postal" class="form-label"
                >Código Postal</label
              >
              <input
                type="text"
                class="form-control"
                id="compra-codigo-postal"
              />
            </div>
          </div>

          <div class="mb-3">
            <label for="compra-pais" class="form-label">País *</label>
            <select class="form-select" id="compra-pais" required>
              <option value="Perú" selected>Perú</option>
              <option value="Argentina">Argentina</option>
              <option value="Chile">Chile</option>
              <option value="Colombia">Colombia</option>
              <option value="México">México</option>
              <option value="España">España</option>
            </select>
          </div>

          <!-- Método de Pago -->
          <h6 class="mb-3 mt-4">
            <i class="bi bi-wallet2 me-2"></i>Método de Pago
          </h6>

          <div class="mb-3">
            <select class="form-select" id="compra-metodo-pago" required>
              <option value="tarjeta" selected>
                Tarjeta de Crédito/Débito
              </option>
              <option value="paypal">PayPal</option>
              <option value="transferencia">Transferencia Bancaria</option>
              <option value="efectivo">Contra Entrega (Efectivo)</option>
            </select>
          </div>

          <!-- Notas Adicionales -->
          <div class="mb-3">
            <label for="compra-notas" class="form-label"
              >Notas Adicionales (Opcional)</label
            >
            <textarea
              class="form-control"
              id="compra-notas"
              rows="3"
              placeholder="Instrucciones de entrega, referencias, etc."
            ></textarea>
          </div>

          <!-- Resumen de Compra -->
          <div class="card bg-light mt-4">
            <div class="card-body">
              <h6 class="card-title mb-3">Resumen de Compra</h6>
              <div class="d-flex justify-content-between mb-2">
                <span>Subtotal:</span>
                <span id="resumen-subtotal">S/ 0.00</span>
              </div>
              <div class="d-flex justify-content-between mb-2">
                <span>Impuestos (IGV 18%):</span>
                <span id="resumen-impuestos">S/ 0.00</span>
              </div>
              <div class="d-flex justify-content-between mb-2">
                <span>Envío:</span>
                <span id="resumen-envio">S/ 0.00</span>
              </div>
              <div class="d-flex justify-content-between mb-2">
                <small class="text-muted"
                  >Envío gratis en compras mayores a S/ 100</small
                >
              </div>
              <hr />
              <div class="d-flex justify-content-between fw-bold fs-5">
                <span>Total:</span>
                <span id="resumen-total" class="text-primary">S/ 0.00</span>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Cancelar
        </button>
        <button
          type="button"
          class="btn btn-primary btn-lg"
          onclick="procesarCompra()"
        >
          <i class="bi bi-check-circle me-2"></i>Confirmar Pedido
        </button>
      </div>
    </div>
  </div>
</div>

<style>
  /* Estilos para los modales de pedidos */
  #misPedidosModal .card,
  #detallePedidoModal .card,
  #confirmarCompraModal .card {
    transition: transform 0.2s, box-shadow 0.2s;
  }

  #misPedidosModal .card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .pedido-item {
    border: 1px solid rgba(110, 87, 255, 0.2);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
    transition: all 0.2s;
  }

  .pedido-item:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 8px rgba(110, 87, 255, 0.3);
  }

  .timeline {
    position: relative;
    padding-left: 30px;
  }

  .timeline::before {
    content: "";
    position: absolute;
    left: 8px;
    top: 0;
    bottom: 0;
    width: 2px;
    background: #e5e7eb;
  }

  .timeline-item {
    position: relative;
    padding-bottom: 1.5rem;
  }

  .timeline-item::before {
    content: "";
    position: absolute;
    left: -26px;
    top: 5px;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--primary);
    border: 3px solid #fff;
    box-shadow: 0 0 0 2px var(--primary);
  }

  .timeline-item.active::before {
    background: #28a745;
    box-shadow: 0 0 0 2px #28a745;
  }
</style>
